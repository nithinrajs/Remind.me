<html>
    <head>
        <title>REMIND ME!</title>
    </head>
    <body>
        <!-- TODO: Text Box with Submit Button -->
        <h1>This will remind you</h1>
        <div id='addevent'>
            <form  action='http://127.0.0.1:5000/event' method='POST'>
                <input type="text" name="name" placeholder="NAME">
                <input name='date' type="text" placeholder="YYYY-MM-DD or MM-DD">
                <input type="submit" value="submit">
            </form>
        </div><br/>
        <div id='events'>
                
        </div>
    </body>

<script>
    function reqJSON(method, url, data) {
        return new Promise((resolve, reject) => {
        let xhr = new XMLHttpRequest();
        xhr.open(method, url);
        xhr.responseType = 'json';
        xhr.onload = () => {
            if (xhr.status >= 200 && xhr.status < 300) {
                resolve({status: xhr.status, data: xhr.response});
            } else {
                reject({status: xhr.status, data: xhr.response});
            }
        };
    xhr.onerror = () => {
      reject({status: xhr.status, data: xhr.response});
    };
    xhr.send(data);
  });
}

        // document.getElementById('btn').addEventListener('click', () => {
        //     let data = document.getElementById('name').value;
        //     console.log(data);
        // });

        document.addEventListener('DOMContentLoaded', () => {
        reqJSON('GET', '/events')
        .then(({status, data}) => {
        console.log(data);
        let html = '';
        for (let event of data.events) {
        html += `${event.name}: ${event.date}<br>`;
        }
        document.getElementById('events').innerHTML = html;
        })
        .catch(({status, data}) => {
        document.getElementById('events').innerHTML = 'ERROR: ' +
        JSON.stringify(data);
        });
        });
</script>
</html>